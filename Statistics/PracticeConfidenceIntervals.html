<!DOCTYPE html>
<html>
<head>
    <title>Confidence Interval Practice Problems</title>
    <style type="text/css">
        body {
            background-color: #D1E7D1;
        }
        h1 {
            text-align: center;
        }
        h2 {
            text-align: center;
        }
        section.container {
            text-align: center;
        }
        h2 {
            margin-top: 20px;
        }
        section {
            margin-bottom: 20px;
        }
        button {
            margin-top: 10px;
        }
        input {
            margin-left: 5px;
        }
        td:nth-child(even) {
            background-color: #f2f2f2;
        }
        table,
        th,
        td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 10px;
            text-align: center;
            margin: 0 auto;
            margin-bottom: 20px;
        }
        .container {
            display: flex;
            justify-content: center;
        }
        .row {
            display: flex;
            flex-direction: row;
            justify-content: center;
        }
        .col {
            flex: 1;
            margin: 10px;
            border: 1px solid black;
            padding: 10px;
        }
    </style>
    <script src="jstat.js"></script>
</head>
<body onload="generate()">
    <h1>Confidence Interval Practice Problems</h1>
    <section class="container">
        <section class="col">
            <h2>Population and Sample Information</h2>
            <p>Population Standard Deviation: <span id="populationSD"></span></p>
            <p>Sample Standard Deviation: <span id="sampleSD"></span></p>
            <p>Sample Mean: <span id="sampleMean"></span></p>
            <p>Number of Samples: <span id="numSamples"></span></p>
            <label><input type="checkbox" id="noSDCheckbox">Population Standard Deviation Not Known</label>
            <br>
            <button onclick="generate()">Generate New Values</button>
        </section>
    </section>
    <section class="container">
        <section class="row">
            <section class="col">
                <h2>90% Confidence Interval</h2>
                <p>Lower Bound: <input type="text" id="lowerBound90"></p>
                <p>Upper Bound: <input type="text" id="upperBound90"></p>
                <button onclick="calculateCI(90)">Calculate Confidence Interval</button>
            </section>
            <section class="col">
                <h2>95% Confidence Interval</h2>
                <p>Lower Bound: <input type="text" id="lowerBound95"></p>
                <p>Upper Bound: <input type="text" id="upperBound95"></p>
                <button onclick="calculateCI(95)">Calculate Confidence Interval</button>
            </section>
            <section class="col">
                <h2>98% Confidence Interval</h2>
                <p>Lower Bound: <input type="text" id="lowerBound98"></p>
                <p>Upper Bound: <input type="text" id="upperBound98"></p>
                <button onclick="calculateCI(98)">Calculate Confidence Interval</button>
            </section>
            <section class="col">
                <h2>99% Confidence Interval</h2>
                <p>Lower Bound: <input type="text" id="lowerBound99"></p>
                <p>Upper Bound: <input type="text" id="upperBound99"></p>
                <button onclick="calculateCI(99)">Calculate Confidence Interval</button>
            </section>      
        </section>
    </section>
    <h1>Critical Values</h1>
    <section class="container">
        <section class="row">
            <table>
                <thead>
                    <tr>
                        <th>Level of Confidence</th>
                        <th>Critical Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>90%</td>
                    <td>1.645</td></tr>
                    <tr><td>95%</td>
                    <td>1.96</td></tr>
                    <tr><td>98%</td>
                    <td>2.33</td></tr>
                    <tr><td>99%</td>
                    <td>2.58</td></tr>
                </tbody>
            </table>
        </section>
    </section>
    <h1>Student's t-Distribution Table</h1>
    <section class="container">
        <section class="row">
            <table>
              <thead>
                <tr>
                  <th>Degrees of Freedom</th>
                  <th>0.500</th>
                  <th>0.750</th>
                  <th>0.800</th>
                  <th>0.850</th>
                  <th>0.900</th>
                  <th>0.950</th>
                  <th>0.980</th>
                  <th>0.990</th>
                  <th>0.999</th>
                </tr>
              </thead>
              <tbody>
                <script>
                  for (var df = 1; df <= 30; df++) {
                    document.write("<tr><td>" + df + "</td>");
                    for (var i = 0; i <= 8; i++) {
                      var t = -jStat.studentt.inv((1-[0.500, 0.750, 0.800, 0.850, 0.900, 0.950, 0.980, 0.990, 0.999][i]) / 2, df);
                      document.write("<td>" + t.toFixed(3) + "</td>");
                    }
                    document.write("</tr>");
                  }
                  for (var df = 35; df <= 50; df = df + 5) {
                    document.write("<tr><td>" + df + "</td>");
                    for (var i = 0; i <= 8; i++) {
                      var t = -jStat.studentt.inv((1-[0.500, 0.750, 0.800, 0.850, 0.900, 0.950, 0.980, 0.990, 0.999][i]) / 2, df);
                      document.write("<td>" + t.toFixed(3) + "</td>");
                    }
                    document.write("</tr>");
                  }
                  for (var df = 60; df <= 100; df = df + 10) {
                    document.write("<tr><td>" + df + "</td>");
                    for (var i = 0; i <= 8; i++) {
                      var t = -jStat.studentt.inv((1-[0.500, 0.750, 0.800, 0.850, 0.900, 0.950, 0.980, 0.990, 0.999][i]) / 2, df);
                      document.write("<td>" + t.toFixed(3) + "</td>");
                    }
                    document.write("</tr>");
                  }
                  for (var df = 200; df <= 1000; df = df + 200) {
                    document.write("<tr><td>" + df + "</td>");
                    for (var i = 0; i <= 8; i++) {
                      var t = -jStat.studentt.inv((1-[0.500, 0.750, 0.800, 0.850, 0.900, 0.950, 0.980, 0.990, 0.999][i]) / 2, df);
                      document.write("<td>" + t.toFixed(3) + "</td>");
                    }
                    document.write("</tr>");
                  }
                </script>
              </tbody>
            </table>
        </section>
    </section>
    <script type="text/javascript">
        function generate() {
			// Generate random values
			var popSd = Math.floor(Math.random() * 15) + 5 + Math.floor(Math.random() * 10) / 10;
            popSd = popSd.toFixed(1);
            var sampleSd = Math.floor(Math.random() * 15) + 5 + Math.floor(Math.random() * 10) / 10;
            sampleSd = sampleSd.toFixed(1);
			var sampleMean = Math.floor(Math.random() * 80) + 10 + Math.floor(Math.random() * 10) / 10;
            sampleMean = sampleMean.toFixed(1);
			var numSamples = Math.floor(Math.random() * 90) + 10;
            numSamples = numSamples.toFixed(0);

			// Display values in HTML
            var noSDCheckbox = document.getElementById("noSDCheckbox").checked;
            if (noSDCheckbox) {
                document.getElementById("populationSD").innerHTML = "Not known";
                document.getElementById("sampleSD").innerHTML = sampleSd;
            } else {
                document.getElementById("populationSD").innerHTML = popSd;
                document.getElementById("sampleSD").innerHTML = "Not known";
            }
            document.getElementById("sampleMean").innerHTML = sampleMean;
			document.getElementById("numSamples").innerHTML = numSamples;

            // Set answers to null.
            document.getElementById("lowerBound90").value = "";
            document.getElementById("upperBound90").value = "";
            document.getElementById("lowerBound95").value = "";
            document.getElementById("upperBound95").value = "";
            document.getElementById("lowerBound98").value = "";
            document.getElementById("upperBound98").value = "";
            document.getElementById("lowerBound99").value = "";
            document.getElementById("upperBound99").value = "";

        }

        function calculateCI(confidence) {
            // Check if population sd is known.
            var noSDCheckbox = document.getElementById("noSDCheckbox").checked;

            if (noSDCheckbox) {
                calculateCIunknownSD(confidence);
            } else {
                calculateCIknownSD(confidence);
            }
        }

        function calculateCIunknownSD(confidence) {

            // Get inputs
            var sampleMean = parseFloat(document.getElementById("sampleMean").innerHTML);
            var sampleSd = parseFloat(document.getElementById("sampleSD").innerHTML);
            var numSamples = parseFloat(document.getElementById("numSamples").innerHTML);

            // Calculate standard error with sample 
            var stdErr = sampleSd / Math.sqrt(numSamples);

            // Get student's t-value from jstat (thanks, Gosset!)
            console.log(confidence);
            var alpha = 1 - confidence/100;
            console.log("alpha: "+alpha);
            var t = -jStat.studentt.inv(alpha/2, numSamples - 1);
            console.log("t: "+t);

            // Calculate confidence interval
            var lowerBound = sampleMean - t * stdErr;
            var upperBound = sampleMean + t * stdErr;
            console.log("Lower bound: " + lowerBound + "; Upper bound: " + upperBound);

            // Display results
            if (confidence == 90) {
                document.getElementById("lowerBound90").value = lowerBound.toFixed(2);
                document.getElementById("upperBound90").value = upperBound.toFixed(2);
            } else if (confidence == 95) {
                document.getElementById("lowerBound95").value = lowerBound.toFixed(2);
                document.getElementById("upperBound95").value = upperBound.toFixed(2);
            } else if (confidence == 98) {
                document.getElementById("lowerBound98").value = lowerBound.toFixed(2);
                document.getElementById("upperBound98").value = upperBound.toFixed(2);
            } else if (confidence == 99) {
                document.getElementById("lowerBound99").value = lowerBound.toFixed(2);
                document.getElementById("upperBound99").value = upperBound.toFixed(2);
            }
        }

        function calculateCIknownSD(confidence) {
           
            // Get inputs
            var sampleMean = parseFloat(document.getElementById("sampleMean").innerHTML);
            var popSd = parseFloat(document.getElementById("populationSD").innerHTML);
            var numSamples = parseFloat(document.getElementById("numSamples").innerHTML);
            
            // Calculate standard error
            var stdErr = popSd / Math.sqrt(numSamples);
            
            // Calculate t-value based on confidence level
            var t;
            if (confidence == 90) {
                t = 1.645;
            } else if (confidence == 95) {
                t = 1.96;
            } else if (confidence == 98) {
                t = 2.33;
            } else if (confidence == 99) {
                t = 2.58;
            }
            
            // Calculate confidence interval
            var lowerBound = sampleMean - t * stdErr;
            var upperBound = sampleMean + t * stdErr;
            
            // Display results
            if (confidence == 90) {
                document.getElementById("lowerBound90").value = lowerBound.toFixed(2);
                document.getElementById("upperBound90").value = upperBound.toFixed(2);
            } else if (confidence == 95) {
                document.getElementById("lowerBound95").value = lowerBound.toFixed(2);
                document.getElementById("upperBound95").value = upperBound.toFixed(2);
            } else if (confidence == 98) {
                document.getElementById("lowerBound98").value = lowerBound.toFixed(2);
                document.getElementById("upperBound98").value = upperBound.toFixed(2);
            } else if (confidence == 99) {
                document.getElementById("lowerBound99").value = lowerBound.toFixed(2);
                document.getElementById("upperBound99").value = upperBound.toFixed(2);
            }
        }
    </script>
</body>
</html>

